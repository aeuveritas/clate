# Create temp directories
RUN mkdir -p \
    /ext \
    $HOME/.vim_runtime/temp_dirs \
    && chown $UNAME:$GROUP $HOME -R

# Install Vim-Plug
RUN su - $UNAME -c "curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim"

# Install plugins for NeoVim
COPY vim/init_init.vim $HOME/.config/nvim/init.vim
RUN chown $UNAME:$GROUP $HOME -R \
    && su - $UNAME -c "nvim +PlugInstall +qall"

RUN su - $UNAME -c 'nvim +"CocInstall coc-highlight coc-json coc-pyls coc-html coc-css coc-yaml coc-snippets coc-emmet coc-tsserver"' \
    & sleep 120

# Cleanup
RUN rm -rf \
    /usr/lib/go \
    /var/log/* \
    /var/tmp/* \
    && mkdir -p /var/cache/apk

